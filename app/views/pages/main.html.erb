<div>
  <span>Olá! <%= current_user.profiles&.first&.name %></span>
  <div class="mt-3">
    <div class="card text-cWhite">
      <span class="fw-bold mb-2"><%= Date.today.strftime("%d/%m/%Y") %></span>
      <div>
        <span class="fw-bold mb-2">Gemba:</span><span> <%= @schedule&.gemba&.name || "Sem gemba definido" %></span>
      </div>
      <div>
        <span class="fw-bold mb-2">Carro:</span><span> Hiace (José)</span>
      </div>
    </div>
  </div>
  <div class="mt-3">
    <div class="card">
      <%= simple_form_for @register, data: { controller: "buttonholder" } do |f| %>
        <div class="">
          <div class="btn-group d-flex justify-content-center gap-4 mb-3" role="group" data-toggle="buttons">
            <%= f.collection_radio_buttons :period_id, Period.all, :id, :description do |b| %>
              <%= b.label(class: "btn btn-cBlue btn-period") do %>
                <%= b.radio_button(class: "btn-check", checked: (b.object == Period.first)) %> <%= b.text %>
              <% end %>
            <% end %>
          </div>
          <%= f.input :date,  as: :string, input_html: { type: "date", class: "form-control rounded-4", value: f.object.date || Date.today }, label: false %>
          <%= f.association :gemba,
            collection: Gemba.where(company_id: current_user.profiles.first.company_id),
            label_method: ->(g) {
              if g.code.present?
                "#{g.code} - #{g.name}"
              else
                g.name
              end
            },
            value_method: :id,
            prompt: "Selecione um Gemba",
            input_html: { class: "form-control rounded-4" },
            label: false %>
          <div class="d-flex gap-3">
            <%= f.input :extra_hour, input_html: { class: "form-control rounded-4"  }, placeholder: "Hora Extra", label: false %>
            <%= f.input :extra_cost, input_html: { class: "form-control rounded-4" }, placeholder: "Custo Extra", label: false %>
          </div>
          <%= f.hidden_field :confirmed, value: "false", data: { buttonholder_target: "hidden" } %>
          <button type="button"
            data-buttonholder-target="button"
            data-action="mousedown->buttonholder#startHold mouseup->buttonholder#cancelHold mouseleave->buttonholder#cancelHold
            touchstart->buttonholder#startHold touchend->buttonholder#cancelHold touchcancel->buttonholder#cancelHold">
            <span class="fill" data-buttonholder-target="fill"></span>
            <span class="text">Hold to Confirm</span>
          </button>
        </div>
      <% end %>
    </div>
  </div>
  <div class="mt-3">
    <%= month_calendar do |date| %>
      <div class="position-relative <%= 'bg-highlight' if @schedules.where(date: date).any? %>">
        <%= date.day %>
        <% if @registers.where(date: date).any? %>
          <div class="mt-1">
            <div class="position-absolute rounded-circle day-circle"></div>
          </div>
        </div>
      <% end %>
    </div>
  <% end %>
</div>
</div>
